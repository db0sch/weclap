(function(b){var a=b.document;if(!("imdb" in b)){b.imdb={}}imdb.rating={response:{},elems:{}};imdb.rating.getElementsByClassName=function(d,c,e){if(a.getElementsByClassName){imdb.rating.getElementsByClassName=function(l,o,k){k=k||a;var f=k.getElementsByClassName(l),n=(o)?new RegExp("\\b"+o+"\\b","i"):null,g=[],j;for(var h=0,m=f.length;h<m;h+=1){j=f[h];if(!n||n.test(j.nodeName)){g.push(j)}}return g}}else{if(a.evaluate){imdb.rating.getElementsByClassName=function(p,s,o){s=s||"*";o=o||a;var h=p.split(" "),q="",m="http://www.w3.org/1999/xhtml",r=(a.documentElement.namespaceURI===m)?m:null,i=[],f,g;for(var k=0,l=h.length;k<l;k+=1){q+="[contains(concat(' ', @class, ' '), ' "+h[k]+" ')]"}try{f=a.evaluate(".//"+s+q,o,r,0,null)}catch(n){f=a.evaluate(".//"+s+q,o,null,0,null)}while((g=f.iterateNext())){i.push(g)}return i}}else{imdb.rating.getElementsByClassName=function(t,w,s){w=w||"*";s=s||a;var j=t.split(" "),v=[],f=(w==="*"&&s.all)?s.all:s.getElementsByTagName(w),r,o=[],q;for(var n=0,g=j.length;n<g;n+=1){v.push(new RegExp("(^|\\s)"+j[n]+"(\\s|$)"))}for(var i=0,u=f.length;i<u;i+=1){r=f[i];q=false;for(var h=0,p=v.length;h<p;h+=1){q=v[h].test(r.className);if(!q){break}}if(q){o.push(r)}}return o}}}return imdb.rating.getElementsByClassName(d,c,e)};imdb.rating.getAttr=function(f,c){var d=f.attributes;for(var e in d){if(d[e]&&d[e].name==c){return d[e].value}}return null};imdb.rating.ready=function(d){var c;if(a.addEventListener){c=function(){a.removeEventListener("DOMContentLoaded",c,false);d()}}else{if(a.attachEvent){c=function(){if(a.readyState==="complete"){a.detachEvent("onreadystatechange",c);d()}}}}if(a.readyState==="complete"){setTimeout(d,1)}if(a.addEventListener){a.addEventListener("DOMContentLoaded",c,false);b.addEventListener("load",d,false)}else{if(a.attachEvent){a.attachEvent("onreadystatechange",c);b.attachEvent("onload",d)}}};imdb.rating.addCommas=function(d){d+="";var c=/(\d+)(\d{3})/;while(c.test(d)){d=d.replace(c,"$1,$2")}return d};imdb.rating.attachCSS=function(){var c=a.getElementsByTagName("head")[0],d=a.createElement("link");d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href","http://g-ecx.images-amazon.com/images/G/01/imdb/plugins/rating/css/imdbRating.min.css");c.appendChild(d)};imdb.rating.buildPlugin=function(n){var m=this.response.id.split("/")[2],k=imdb.rating.elems[m]["elem"],h=imdb.rating.elems[m]["elem"].getElementsByTagName("a")[0],l=a.createElement("span"),f=typeof(this.response.rating)==="number"?this.response.rating.toFixed(1):"N/A",c=a.createTextNode(f),e=a.createElement("span"),i=a.createTextNode("/10");k.className=k.className+" "+n.style;if(f){l.className="rating";l.appendChild(c);e.className="ofTen";e.appendChild(i);l.appendChild(e);k.appendChild(l)}if(typeof(n.starImg)==="string"){var g=a.createElement("img");g.src="http://g-ecx.images-amazon.com/images/G/01/imdb/plugins/rating/images/"+n.starImg;g.className="star";k.appendChild(g)}if(n.showVotes===true&&this.response.ratingCount){var j=a.createTextNode(this.addCommas(this.response.ratingCount)+" votes"),d=a.createElement("span");d.className="votes";d.appendChild(j);k.appendChild(d)}};imdb.rating.setResponse=function(c){if(typeof(c)==="object"){this.response=c.resource}else{this.response.rating="N/A";this.response.ratingCount=0}};imdb.rating.run=function(c){this.setResponse(c);var f=this.response.id.split("/")[2];var e=imdb.rating.elems[f]["elem"];var d=imdb.rating.elems[f]["style"];imdb.rating[d]()};imdb.rating.t1=imdb.rating.p1=function(){this.buildPlugin({style:"imdbRatingStyle1",imdbLogo:"imdb_46x22.png",starImg:"imdb_star_22x21.png"})};imdb.rating.p2=function(){this.buildPlugin({style:"imdbRatingStyle2",imdbLogo:"imdb_38x18.png",starImg:"imdb_star_17x17.png"})};imdb.rating.p3=function(){this.buildPlugin({style:"imdbRatingStyle3",imdbLogo:"imdb_37x18.png",showVotes:true})};imdb.rating.p4=function(){this.buildPlugin({style:"imdbRatingStyle4",imdbLogo:"imdb_31x14"})};imdb.rating.p5=function(){this.buildPlugin({style:"imdbRatingStyle5",showVotes:true})};imdb.rating.createJSONP=function(){var h=imdb.rating.getElementsByClassName("imdbRatingPlugin");for(var d in h){var g=imdb.rating.getAttr(h[d],"data-title"),e=imdb.rating.getAttr(h[d],"data-style"),c=imdb.rating.getAttr(h[d],"data-user");if(!a.getElementById("imdb-jsonp-"+g)){imdb.rating.elems[g]={};imdb.rating.elems[g]["elem"]=h[d];imdb.rating.elems[g]["style"]=e;var f=a.createElement("script");f.src="http://p.media-imdb.com/static-content/documents/v1/title/"+g+"/ratings%3Fjsonp=imdb.rating.run:imdb.api.title.ratings/data.json?u="+c+"&s="+e;f.id="imdb-jsonp-"+g;a.body.appendChild(f)}}};imdb.rating.ready(function(){imdb.rating.attachCSS();imdb.rating.createJSONP()})})(window);
